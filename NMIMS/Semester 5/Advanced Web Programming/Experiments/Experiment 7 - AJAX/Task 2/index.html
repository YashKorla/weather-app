<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1.0"
		/>
		<title>Experiment 8 | AJAX</title>
	</head>
	<body>
		<input
			type="text"
			onkeypress="fetchData()"
			placeholder="Enter Name..."
			id="input"
		/>
		<p id="matched-names"></p>
	</body>
	<script>
		fetchData = () => {
			xmlHTTP = new XMLHttpRequest();
			xmlHTTP.onreadystatechange = (obj) => {
				if (obj.target.readyState == 4 && obj.target.status == 200) {
					addRows(obj.target);
				}
			};
			xmlHTTP.open("GET", "names.xml", true);
			xmlHTTP.send();
		};

		addRows = (xmlObject) => {
			let xmlDoc = xmlObject.responseXML;
			let names = xmlDoc.getElementsByTagName("name");
			let para = document.getElementById("matched-names");
			para.innerHTML = "";
			for (let i = 0; i < names.length; i++) {
				let input = document.getElementById("input").value.toLowerCase();
				let name = xmlDoc.getElementsByTagName("name")[i].childNodes[0].nodeValue;
				let nameLower = name.toLowerCase();

				if (nameLower.includes(input)) {
					para.innerHTML += name + "<br />";
				}
			}
		};
	</script>
</html>
