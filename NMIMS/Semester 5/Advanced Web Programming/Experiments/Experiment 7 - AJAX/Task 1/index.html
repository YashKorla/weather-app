<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1.0"
		/>
		<title>Experiment 8 | AJAX</title>
	</head>
	<body>
		<button onclick="getDetails()">Get Book Collection</button>
		<table
			id="book-details"
			class="table"
		>
			<thead>
				<th>Title</th>
				<th>Author</th>
				<th>Price</th>
				<th>Year</th>
			</thead>
			<tbody id="book-details-body"></tbody>
		</table>
	</body>
	<script>
		getDetails = () => {
			xmlHTTP = new XMLHttpRequest();
			xmlHTTP.onreadystatechange = (obj) => {
				if (obj.target.readyState == 4 && obj.target.status == 200) {
					addRows(obj.target);
				}
			};
			xmlHTTP.open("GET", "book.xml", true);
			xmlHTTP.send();
		};

		addRows = (xmlObject) => {
			xmlDoc = xmlObject.responseXML;
			bookDetails = xmlDoc.getElementsByTagName("book");
			table = document.getElementById("book-details-body");
			rows = table.rows.length;

			for (i = 0; i < bookDetails.length; i++) {
				row = table.insertRow(i);

				title = row.insertCell(0);
				author = row.insertCell(1);
				price = row.insertCell(2);
				year = row.insertCell(3);

				title.innerHTML = xmlDoc
					.getElementsByTagName("book")
					[i].getElementsByTagName("TITLE")[0].childNodes[0].nodeValue;

				author.innerHTML = xmlDoc
					.getElementsByTagName("book")
					[i].getElementsByTagName("AUTHOR")[0].childNodes[0].nodeValue;

				price.innerHTML = xmlDoc
					.getElementsByTagName("book")
					[i].getElementsByTagName("PRICE")[0].childNodes[0].nodeValue;

				year.innerHTML = xmlDoc
					.getElementsByTagName("book")
					[i].getElementsByTagName("YEAR")[0].childNodes[0].nodeValue;
			}
		};
	</script>
</html>
